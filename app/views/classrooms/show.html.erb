<% content_for :title, "Classroom Details" %>

<div class="page-header">
  <div>
    <h1 class="page-header__title"><%= @classroom.name %></h1>
    <p class="page-header__subtitle">Classroom profile</p>
  </div>

  <div class="page-actions">
    <% if current_user.admin? || (current_user.teacher? && @classroom.teacher == current_user) %>
      <%= link_to "Edit", edit_classroom_path(@classroom), class: "btn btn-primary" %>
    <% end %>
    <%= link_to "Back", classrooms_path, class: "btn btn-ghost" %>
  </div>
</div>

<div class="form-grid" style="margin-bottom:14px;">
  <div class="card">
    <h3 style="margin:0 0 12px 0;">Overview</h3>

    <div class="form-group">
      <div class="form-label">Teacher</div>
      <div class="readonly"><%= @classroom.teacher&.name || "Unassigned" %></div>
    </div>

    <div class="form-grid">
      <div class="form-group">
        <div class="form-label">Capacity</div>
        <div class="readonly"><%= @classroom.capacity %></div>
      </div>

      <div class="form-group">
        <div class="form-label">Student count</div>
        <div class="readonly"><%= @classroom.students.count %> / <%= @classroom.capacity %></div>
      </div>
    </div>
  </div>

  <div class="card">
    <h3 style="margin:0 0 12px 0;">Details</h3>

    <div class="form-group">
      <div class="form-label">Description</div>
      <div class="readonly" style="height:auto; padding:10px 12px; align-items:flex-start;">
        <%= @classroom.description.presence || "—" %>
      </div>
    </div>

    <div class="form-group">
      <div class="form-label">Schedule</div>
      <div class="readonly" style="height:auto; padding:10px 12px; align-items:flex-start;">
        <%= @classroom.schedule.presence || "—" %>
      </div>
    </div>
  </div>
</div>

<div class="card">
  <div class="page-header" style="margin-bottom:10px;">
    <div>
      <h2 class="page-header__title" style="font-size:1.05rem;">Students</h2>
      <p class="page-header__subtitle">Students currently assigned to this classroom.</p>
    </div>

    <div class="page-actions">
      <% if current_user.admin? || current_user.teacher? %>
        <%= link_to "Add Student", new_student_path, class: "btn btn-primary" %>
      <% end %>
    </div>
  </div>

  <% if @classroom.students.any? %>
    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Student</th>
            <th>Status</th>
            <th>Gender</th>
            <th class="no-sort">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @classroom.students.each do |student| %>
            <tr>
              <td><%= student.id %></td>
              <td><%= student.full_name %></td>
              <td>
                <span class="status-badge status-<%= student.status %>"><%= student.status.humanize %></span>
              </td>
              <td><%= student.gender&.humanize || "—" %></td>
              <td>
                <%= link_to "View", student, class: "btn btn-sm" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="form-help">No students are currently assigned to this classroom.</div>
  <% end %>
</div>
