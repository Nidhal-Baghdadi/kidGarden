<% content_for :title, @resource.title %>

<div class="page-header">
  <div>
    <h1 class="page-header__title"><%= @resource.title %></h1>
    <p class="page-header__subtitle">
      <%= @resource.category.present? ? @resource.category.humanize : "Resource" %>
      • <%= @resource.classroom&.name || "All Classrooms" %>
    </p>
  </div>

  <div class="page-actions">
    <% if current_user.admin? || current_user.id == @resource.user_id %>
      <%= link_to "Edit", edit_resource_path(@resource), class: "btn btn-primary" %>
    <% end %>
    <%= link_to "Back", resources_path, class: "btn" %>
  </div>
</div>

<div class="form-grid" style="margin-bottom:14px;">
  <div class="card">
    <h3 style="margin:0 0 12px 0;">Details</h3>

    <div class="form-group">
      <div class="form-label">Subject</div>
      <div class="readonly"><%= @resource.subject.presence || "—" %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Classroom</div>
      <div class="readonly"><%= @resource.classroom&.name || "All Classrooms" %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Uploaded by</div>
      <div class="readonly"><%= @resource.user&.name || "System" %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Uploaded</div>
      <div class="readonly"><%= @resource.created_at.strftime("%B %d, %Y at %I:%M %p") %></div>
    </div>
  </div>

  <div class="card">
    <h3 style="margin:0 0 12px 0;">Description</h3>
    <div class="readonly" style="height:auto; padding:10px 12px; align-items:flex-start;">
      <%= @resource.description.presence || "No description provided." %>
    </div>
  </div>
</div>

<div class="card">
  <h3 style="margin:0 0 12px 0;">File</h3>

  <% if @resource.file.attached? %>
    <div class="form-grid">
      <div class="form-group">
        <div class="form-label">Filename</div>
        <div class="readonly"><%= @resource.file.filename %></div>
      </div>

      <div class="form-group">
        <div class="form-label">Size</div>
        <div class="readonly"><%= number_to_human_size(@resource.file.byte_size) %></div>
      </div>

      <div class="form-group">
        <div class="form-label">Content type</div>
        <div class="readonly"><%= @resource.file.content_type %></div>
      </div>

      <div class="form-group" style="display:flex; align-items:end; gap:10px;">
        <%= link_to "Download",
              rails_blob_path(@resource.file, disposition: "attachment"),
              class: "btn btn-primary" %>
      </div>
    </div>
  <% else %>
    <div class="form-help">No file attached to this resource.</div>
  <% end %>
</div>
