<% content_for :title, @parent.name %>

<div class="page-header">
  <div>
    <h1 class="page-header__title"><%= @parent.name %></h1>
    <p class="page-header__subtitle">Parent profile and linked children.</p>
  </div>

  <div class="page-actions">
    <% if current_user.admin? %>
      <%= link_to "Edit", edit_parent_path(@parent), class: "btn" %>
      <%= link_to "Delete", @parent,
          method: :delete,
          data: { confirm: "Are you sure?" },
          class: "btn btn-ghost" %>
    <% end %>

    <%= link_to "Back to Parents", parents_path, class: "btn btn-ghost" %>
  </div>
</div>

<div class="form-grid">
  <div class="card">
    <h3 style="margin:0 0 12px 0;">Parent Information</h3>

    <div class="form-group">
      <div class="form-label">Name</div>
      <div class="readonly"><%= @parent.name %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Email</div>
      <div class="readonly"><%= @parent.email %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Phone</div>
      <div class="readonly"><%= @parent.phone.presence || "—" %></div>
    </div>

    <div class="form-group">
      <div class="form-label">Address</div>
      <div class="readonly"><%= @parent.address.presence || "—" %></div>
    </div>

    <div class="form-group" style="margin-bottom:0;">
      <div class="form-label">Joined</div>
      <div class="readonly"><%= @parent.created_at.strftime("%B %d, %Y") %></div>
    </div>
  </div>

  <div class="card" style="grid-column: span 1 / span 1;">
    <h3 style="margin:0 0 12px 0;">Children</h3>

    <% if @parent.students_as_parent.any? %>
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Student</th>
              <th>Classroom</th>
              <th>Status</th>
              <th class="no-sort">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @parent.students_as_parent.each do |student| %>
              <tr>
                <td><%= student.first_name %> <%= student.last_name %></td>
                <td><%= student.classroom&.name || "Unassigned" %></td>
                <td>
                  <span class="status-badge status-<%= student.status %>">
                    <%= student.status.humanize %>
                  </span>
                </td>
                <td>
                  <%= link_to "View", student, class: "btn btn-sm" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="form-help">No children assigned to this parent.</div>
    <% end %>
  </div>
</div>

<div class="card" style="margin-top: 14px;">
  <h3 style="margin:0 0 6px 0;">Recent Activity</h3>
  <p class="form-help" style="margin:0;">Recent communications and interactions with this parent.</p>
  <!-- Add recent activity logs here -->
</div>
