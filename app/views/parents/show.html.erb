<% content_for :title, @parent.name %>

<div class="d-flex justify-between items-center mb-4">
  <h1><%= @parent.name %></h1>
  <div class="flex space-x-2">
    <% if current_user.admin? %>
      <%= link_to "Edit", edit_parent_path(@parent), class: "btn btn-outline" %>
      <%= link_to "Delete", @parent, method: :delete, class: "btn btn-danger",
                  confirm: "Are you sure?", style: "margin-left: 0.25rem;" %>
    <% end %>
    <%= link_to "Back to Parents", parents_path, class: "btn btn-outline ml-2" %>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
  <div class="card md:col-span-1">
    <h3>Parent Information</h3>
    <div class="space-y-3">
      <div>
        <label class="text-sm font-medium text-gray-500">Name</label>
        <p class="text-lg font-semibold"><%= @parent.name %></p>
      </div>
      <div>
        <label class="text-sm font-medium text-gray-500">Email</label>
        <p><%= @parent.email %></p>
      </div>
      <div>
        <label class="text-sm font-medium text-gray-500">Phone</label>
        <p><%= @parent.phone || "N/A" %></p>
      </div>
      <div>
        <label class="text-sm font-medium text-gray-500">Address</label>
        <p><%= @parent.address || "N/A" %></p>
      </div>
      <div>
        <label class="text-sm font-medium text-gray-500">Joined</label>
        <p><%= @parent.created_at.strftime("%B %d, %Y") %></p>
      </div>
    </div>
  </div>

  <div class="card md:col-span-2">
    <h3>Children</h3>
    <% if @parent.students_as_parent.any? %>
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>Student Name</th>
              <th>Classroom</th>
              <th>Age</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @parent.students_as_parent.each do |student| %>
              <tr>
                <td>
                  <div class="font-medium"><%= student.first_name %> <%= student.last_name %></div>
                </td>
                <td><%= student.classroom&.name || "Unassigned" %></td>
                <td><%= student.age %></td>
                <td>
                  <span class="status-badge status-<%= student.status %>">
                    <%= student.status.humanize %>
                  </span>
                </td>
                <td>
                  <%= link_to "View", student, class: "btn btn-outline btn-sm" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p>No children assigned to this parent.</p>
    <% end %>
  </div>
</div>

<div class="card mt-6">
  <h3>Recent Activity</h3>
  <p>Recent communications and interactions with this parent.</p>
  <!-- Add recent activity logs here -->
</div>